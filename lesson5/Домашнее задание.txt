Все задания необходимо выполнить с использованием подзапросов. Помните, что подзапросы могут быть независимыми и коррелированными.
Ответы не предоставляются, так как запросы будут возвращать наборы строк. Решение валидируйте через ТГ-бота.
Напоминаю, что из-за особенностей работы подзапросов в ClickHouse некоторые задачи выполнить невозможно.
Учитывайте, что в ClickHouse, если магазин не был закрыт, то дата закрытия указана как "1970-01-01".
Помните, что невозможно охватить все за время проведения занятий, поэтому важно развивать навык поиска информации в интернете и в документации.

1. Найти товары (вывести id), цена которых выше средней цены в своей категории. Подказка: WHERE.
2. Найти города (вывести уникальные названия), где есть закрытые магазины. Подказка: WHERE EXISTS.
3. Найти покупателей (вывести customer_id), у которых сумма покупок больше средней суммы покупок всех покупателей. Подказка: HAVING, FROM.
4. Вывести id транзакции, название магазина, в котором была совершена покупка за последние 5 месяцев. Подсказка: SELECT, INTERVAL.